{"version":4,"terraform_version":"1.9.0","serial":1,"lineage":"7a7b5225-b236-8a4c-2f60-7aa8c459b697","outputs":{"lambda_deploy_apply_role_arn":{"value":"arn:aws:iam::054037125242:role/lambda-sample-apply","type":"string"},"lambda_deploy_plan_role_arn":{"value":"arn:aws:iam::054037125242:role/lambda-sample-plan","type":"string"},"lambda_test_role_arn":{"value":"arn:aws:iam::054037125242:role/lambda-sample-tests","type":"string"}},"resources":[{"module":"module.iam_roles","mode":"data","type":"aws_iam_policy_document","name":"apply_serverless_app","provider":"provider[\"registry.opentofu.org/hashicorp/aws\"]","instances":[{"index_key":0,"schema_version":0,"attributes":{"id":"1158834840","json":"{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Sid\": \"IamPermissions\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"iam:UpdateRole\",\n        \"iam:PassRole\",\n        \"iam:List*Role*\",\n        \"iam:Get*Role*\",\n        \"iam:DeleteRole\",\n        \"iam:CreateRole\"\n      ],\n      \"Resource\": \"arn:aws:iam::*:role/lambda-sample*\"\n    },\n    {\n      \"Sid\": \"ServerlessPermissions\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"lambda:*\",\n        \"apigatewayv2:*\",\n        \"apigateway:*\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Sid\": \"TofuStateS3Permissions\",\n      \"Effect\": \"Allow\",\n      \"Action\": \"s3:*\",\n      \"Resource\": [\n        \"arn:aws:s3:::fundamentals-of-devops-tofu-state/*\",\n        \"arn:aws:s3:::fundamentals-of-devops-tofu-state\"\n      ]\n    },\n    {\n      \"Sid\": \"TofuStateDynamoPermissions\",\n      \"Effect\": \"Allow\",\n      \"Action\": \"dynamodb:*\",\n      \"Resource\": \"arn:aws:dynamodb:*:*:table/fundamentals-of-devops-tofu-state\"\n    }\n  ]\n}","minified_json":"{\"Version\":\"2012-10-17\",\"Statement\":[{\"Sid\":\"IamPermissions\",\"Effect\":\"Allow\",\"Action\":[\"iam:UpdateRole\",\"iam:PassRole\",\"iam:List*Role*\",\"iam:Get*Role*\",\"iam:DeleteRole\",\"iam:CreateRole\"],\"Resource\":\"arn:aws:iam::*:role/lambda-sample*\"},{\"Sid\":\"ServerlessPermissions\",\"Effect\":\"Allow\",\"Action\":[\"lambda:*\",\"apigatewayv2:*\",\"apigateway:*\"],\"Resource\":\"*\"},{\"Sid\":\"TofuStateS3Permissions\",\"Effect\":\"Allow\",\"Action\":\"s3:*\",\"Resource\":[\"arn:aws:s3:::fundamentals-of-devops-tofu-state/*\",\"arn:aws:s3:::fundamentals-of-devops-tofu-state\"]},{\"Sid\":\"TofuStateDynamoPermissions\",\"Effect\":\"Allow\",\"Action\":\"dynamodb:*\",\"Resource\":\"arn:aws:dynamodb:*:*:table/fundamentals-of-devops-tofu-state\"}]}","override_json":null,"override_policy_documents":null,"policy_id":null,"source_json":null,"source_policy_documents":null,"statement":[{"actions":["iam:CreateRole","iam:DeleteRole","iam:Get*Role*","iam:List*Role*","iam:PassRole","iam:UpdateRole"],"condition":[],"effect":"Allow","not_actions":[],"not_principals":[],"not_resources":[],"principals":[],"resources":["arn:aws:iam::*:role/lambda-sample*"],"sid":"IamPermissions"},{"actions":["apigateway:*","apigatewayv2:*","lambda:*"],"condition":[],"effect":"Allow","not_actions":[],"not_principals":[],"not_resources":[],"principals":[],"resources":["*"],"sid":"ServerlessPermissions"},{"actions":["s3:*"],"condition":[],"effect":"Allow","not_actions":[],"not_principals":[],"not_resources":[],"principals":[],"resources":["arn:aws:s3:::fundamentals-of-devops-tofu-state","arn:aws:s3:::fundamentals-of-devops-tofu-state/*"],"sid":"TofuStateS3Permissions"},{"actions":["dynamodb:*"],"condition":[],"effect":"Allow","not_actions":[],"not_principals":[],"not_resources":[],"principals":[],"resources":["arn:aws:dynamodb:*:*:table/fundamentals-of-devops-tofu-state"],"sid":"TofuStateDynamoPermissions"}],"version":"2012-10-17"},"sensitive_attributes":[]}]},{"module":"module.iam_roles","mode":"data","type":"aws_iam_policy_document","name":"assume_role_policy_for_apply","provider":"provider[\"registry.opentofu.org/hashicorp/aws\"]","instances":[{"index_key":0,"schema_version":0,"attributes":{"id":"760320877","json":"{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": \"sts:AssumeRoleWithWebIdentity\",\n      \"Principal\": {\n        \"Federated\": \"arn:aws:iam::054037125242:oidc-provider/token.actions.githubusercontent.com\"\n      },\n      \"Condition\": {\n        \"StringEquals\": {\n          \"token.actions.githubusercontent.com:aud\": \"sts.amazonaws.com\",\n          \"token.actions.githubusercontent.com:sub\": \"repo:brikis98/fundamentals-of-devops-examples:ref:refs/heads/main\"\n        }\n      }\n    }\n  ]\n}","minified_json":"{\"Version\":\"2012-10-17\",\"Statement\":[{\"Effect\":\"Allow\",\"Action\":\"sts:AssumeRoleWithWebIdentity\",\"Principal\":{\"Federated\":\"arn:aws:iam::054037125242:oidc-provider/token.actions.githubusercontent.com\"},\"Condition\":{\"StringEquals\":{\"token.actions.githubusercontent.com:aud\":\"sts.amazonaws.com\",\"token.actions.githubusercontent.com:sub\":\"repo:brikis98/fundamentals-of-devops-examples:ref:refs/heads/main\"}}}]}","override_json":null,"override_policy_documents":null,"policy_id":null,"source_json":null,"source_policy_documents":null,"statement":[{"actions":["sts:AssumeRoleWithWebIdentity"],"condition":[{"test":"StringEquals","values":["repo:brikis98/fundamentals-of-devops-examples:ref:refs/heads/main"],"variable":"token.actions.githubusercontent.com:sub"},{"test":"StringEquals","values":["sts.amazonaws.com"],"variable":"token.actions.githubusercontent.com:aud"}],"effect":"Allow","not_actions":[],"not_principals":[],"not_resources":[],"principals":[{"identifiers":["arn:aws:iam::054037125242:oidc-provider/token.actions.githubusercontent.com"],"type":"Federated"}],"resources":[],"sid":""}],"version":"2012-10-17"},"sensitive_attributes":[]}]},{"module":"module.iam_roles","mode":"data","type":"aws_iam_policy_document","name":"assume_role_policy_for_plan","provider":"provider[\"registry.opentofu.org/hashicorp/aws\"]","instances":[{"index_key":0,"schema_version":0,"attributes":{"id":"378699522","json":"{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": \"sts:AssumeRoleWithWebIdentity\",\n      \"Principal\": {\n        \"Federated\": \"arn:aws:iam::054037125242:oidc-provider/token.actions.githubusercontent.com\"\n      },\n      \"Condition\": {\n        \"StringEquals\": {\n          \"token.actions.githubusercontent.com:aud\": \"sts.amazonaws.com\"\n        },\n        \"StringLike\": {\n          \"token.actions.githubusercontent.com:sub\": \"repo:brikis98/fundamentals-of-devops-examples:*\"\n        }\n      }\n    }\n  ]\n}","minified_json":"{\"Version\":\"2012-10-17\",\"Statement\":[{\"Effect\":\"Allow\",\"Action\":\"sts:AssumeRoleWithWebIdentity\",\"Principal\":{\"Federated\":\"arn:aws:iam::054037125242:oidc-provider/token.actions.githubusercontent.com\"},\"Condition\":{\"StringEquals\":{\"token.actions.githubusercontent.com:aud\":\"sts.amazonaws.com\"},\"StringLike\":{\"token.actions.githubusercontent.com:sub\":\"repo:brikis98/fundamentals-of-devops-examples:*\"}}}]}","override_json":null,"override_policy_documents":null,"policy_id":null,"source_json":null,"source_policy_documents":null,"statement":[{"actions":["sts:AssumeRoleWithWebIdentity"],"condition":[{"test":"StringEquals","values":["sts.amazonaws.com"],"variable":"token.actions.githubusercontent.com:aud"},{"test":"StringLike","values":["repo:brikis98/fundamentals-of-devops-examples:*"],"variable":"token.actions.githubusercontent.com:sub"}],"effect":"Allow","not_actions":[],"not_principals":[],"not_resources":[],"principals":[{"identifiers":["arn:aws:iam::054037125242:oidc-provider/token.actions.githubusercontent.com"],"type":"Federated"}],"resources":[],"sid":""}],"version":"2012-10-17"},"sensitive_attributes":[]}]},{"module":"module.iam_roles","mode":"data","type":"aws_iam_policy_document","name":"assume_role_policy_for_tests","provider":"provider[\"registry.opentofu.org/hashicorp/aws\"]","instances":[{"index_key":0,"schema_version":0,"attributes":{"id":"378699522","json":"{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": \"sts:AssumeRoleWithWebIdentity\",\n      \"Principal\": {\n        \"Federated\": \"arn:aws:iam::054037125242:oidc-provider/token.actions.githubusercontent.com\"\n      },\n      \"Condition\": {\n        \"StringEquals\": {\n          \"token.actions.githubusercontent.com:aud\": \"sts.amazonaws.com\"\n        },\n        \"StringLike\": {\n          \"token.actions.githubusercontent.com:sub\": \"repo:brikis98/fundamentals-of-devops-examples:*\"\n        }\n      }\n    }\n  ]\n}","minified_json":"{\"Version\":\"2012-10-17\",\"Statement\":[{\"Effect\":\"Allow\",\"Action\":\"sts:AssumeRoleWithWebIdentity\",\"Principal\":{\"Federated\":\"arn:aws:iam::054037125242:oidc-provider/token.actions.githubusercontent.com\"},\"Condition\":{\"StringEquals\":{\"token.actions.githubusercontent.com:aud\":\"sts.amazonaws.com\"},\"StringLike\":{\"token.actions.githubusercontent.com:sub\":\"repo:brikis98/fundamentals-of-devops-examples:*\"}}}]}","override_json":null,"override_policy_documents":null,"policy_id":null,"source_json":null,"source_policy_documents":null,"statement":[{"actions":["sts:AssumeRoleWithWebIdentity"],"condition":[{"test":"StringEquals","values":["sts.amazonaws.com"],"variable":"token.actions.githubusercontent.com:aud"},{"test":"StringLike","values":["repo:brikis98/fundamentals-of-devops-examples:*"],"variable":"token.actions.githubusercontent.com:sub"}],"effect":"Allow","not_actions":[],"not_principals":[],"not_resources":[],"principals":[{"identifiers":["arn:aws:iam::054037125242:oidc-provider/token.actions.githubusercontent.com"],"type":"Federated"}],"resources":[],"sid":""}],"version":"2012-10-17"},"sensitive_attributes":[]}]},{"module":"module.iam_roles","mode":"data","type":"aws_iam_policy_document","name":"plan_serverless_app","provider":"provider[\"registry.opentofu.org/hashicorp/aws\"]","instances":[{"index_key":0,"schema_version":0,"attributes":{"id":"3050954502","json":"{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Sid\": \"IamReadOnlyPermissions\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"iam:List*Role*\",\n        \"iam:Get*Role*\"\n      ],\n      \"Resource\": \"arn:aws:iam::*:role/lambda-sample*\"\n    },\n    {\n      \"Sid\": \"ServerlessReadOnlyPermissions\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"lambda:List*\",\n        \"lambda:Get*\",\n        \"apigatewayv2:Get*\",\n        \"apigateway:GET\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Sid\": \"TofuStateS3ReadOnlyPermissions\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"s3:List*\",\n        \"s3:Get*\"\n      ],\n      \"Resource\": [\n        \"arn:aws:s3:::fundamentals-of-devops-tofu-state/*\",\n        \"arn:aws:s3:::fundamentals-of-devops-tofu-state\"\n      ]\n    }\n  ]\n}","minified_json":"{\"Version\":\"2012-10-17\",\"Statement\":[{\"Sid\":\"IamReadOnlyPermissions\",\"Effect\":\"Allow\",\"Action\":[\"iam:List*Role*\",\"iam:Get*Role*\"],\"Resource\":\"arn:aws:iam::*:role/lambda-sample*\"},{\"Sid\":\"ServerlessReadOnlyPermissions\",\"Effect\":\"Allow\",\"Action\":[\"lambda:List*\",\"lambda:Get*\",\"apigatewayv2:Get*\",\"apigateway:GET\"],\"Resource\":\"*\"},{\"Sid\":\"TofuStateS3ReadOnlyPermissions\",\"Effect\":\"Allow\",\"Action\":[\"s3:List*\",\"s3:Get*\"],\"Resource\":[\"arn:aws:s3:::fundamentals-of-devops-tofu-state/*\",\"arn:aws:s3:::fundamentals-of-devops-tofu-state\"]}]}","override_json":null,"override_policy_documents":null,"policy_id":null,"source_json":null,"source_policy_documents":null,"statement":[{"actions":["iam:Get*Role*","iam:List*Role*"],"condition":[],"effect":"Allow","not_actions":[],"not_principals":[],"not_resources":[],"principals":[],"resources":["arn:aws:iam::*:role/lambda-sample*"],"sid":"IamReadOnlyPermissions"},{"actions":["apigateway:GET","apigatewayv2:Get*","lambda:Get*","lambda:List*"],"condition":[],"effect":"Allow","not_actions":[],"not_principals":[],"not_resources":[],"principals":[],"resources":["*"],"sid":"ServerlessReadOnlyPermissions"},{"actions":["s3:Get*","s3:List*"],"condition":[],"effect":"Allow","not_actions":[],"not_principals":[],"not_resources":[],"principals":[],"resources":["arn:aws:s3:::fundamentals-of-devops-tofu-state","arn:aws:s3:::fundamentals-of-devops-tofu-state/*"],"sid":"TofuStateS3ReadOnlyPermissions"}],"version":"2012-10-17"},"sensitive_attributes":[]}]},{"module":"module.iam_roles","mode":"data","type":"aws_iam_policy_document","name":"test_serverless_app","provider":"provider[\"registry.opentofu.org/hashicorp/aws\"]","instances":[{"index_key":0,"schema_version":0,"attributes":{"id":"20064046","json":"{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Sid\": \"IamPermissions\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"iam:UpdateRole\",\n        \"iam:PassRole\",\n        \"iam:List*Role*\",\n        \"iam:Get*Role*\",\n        \"iam:DeleteRole\",\n        \"iam:CreateRole\"\n      ],\n      \"Resource\": \"arn:aws:iam::*:role/lambda-sample*\"\n    },\n    {\n      \"Sid\": \"ServerlessPermissions\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"lambda:*\",\n        \"apigatewayv2:*\",\n        \"apigateway:*\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}","minified_json":"{\"Version\":\"2012-10-17\",\"Statement\":[{\"Sid\":\"IamPermissions\",\"Effect\":\"Allow\",\"Action\":[\"iam:UpdateRole\",\"iam:PassRole\",\"iam:List*Role*\",\"iam:Get*Role*\",\"iam:DeleteRole\",\"iam:CreateRole\"],\"Resource\":\"arn:aws:iam::*:role/lambda-sample*\"},{\"Sid\":\"ServerlessPermissions\",\"Effect\":\"Allow\",\"Action\":[\"lambda:*\",\"apigatewayv2:*\",\"apigateway:*\"],\"Resource\":\"*\"}]}","override_json":null,"override_policy_documents":null,"policy_id":null,"source_json":null,"source_policy_documents":null,"statement":[{"actions":["iam:CreateRole","iam:DeleteRole","iam:Get*Role*","iam:List*Role*","iam:PassRole","iam:UpdateRole"],"condition":[],"effect":"Allow","not_actions":[],"not_principals":[],"not_resources":[],"principals":[],"resources":["arn:aws:iam::*:role/lambda-sample*"],"sid":"IamPermissions"},{"actions":["apigateway:*","apigatewayv2:*","lambda:*"],"condition":[],"effect":"Allow","not_actions":[],"not_principals":[],"not_resources":[],"principals":[],"resources":["*"],"sid":"ServerlessPermissions"}],"version":"2012-10-17"},"sensitive_attributes":[]}]},{"module":"module.iam_roles","mode":"managed","type":"aws_iam_role","name":"lambda_deploy_apply","provider":"provider[\"registry.opentofu.org/hashicorp/aws\"]","instances":[{"index_key":0,"schema_version":0,"attributes":{"arn":"arn:aws:iam::054037125242:role/lambda-sample-apply","assume_role_policy":"{\"Statement\":[{\"Action\":\"sts:AssumeRoleWithWebIdentity\",\"Condition\":{\"StringEquals\":{\"token.actions.githubusercontent.com:aud\":\"sts.amazonaws.com\",\"token.actions.githubusercontent.com:sub\":\"repo:brikis98/fundamentals-of-devops-examples:ref:refs/heads/main\"}},\"Effect\":\"Allow\",\"Principal\":{\"Federated\":\"arn:aws:iam::054037125242:oidc-provider/token.actions.githubusercontent.com\"}}],\"Version\":\"2012-10-17\"}","create_date":"2025-01-20T17:40:21Z","description":"","force_detach_policies":false,"id":"lambda-sample-apply","inline_policy":[],"managed_policy_arns":[],"max_session_duration":3600,"name":"lambda-sample-apply","name_prefix":"","path":"/","permissions_boundary":"","tags":null,"tags_all":{},"unique_id":"AROAQZFG5DB5HSKYUWD4R"},"sensitive_attributes":[],"private":"bnVsbA==","dependencies":["module.iam_roles.data.aws_iam_policy_document.assume_role_policy_for_apply","module.oidc_provider.aws_iam_openid_connect_provider.github_actions","module.oidc_provider.data.tls_certificate.github"]}]},{"module":"module.iam_roles","mode":"managed","type":"aws_iam_role","name":"lambda_deploy_plan","provider":"provider[\"registry.opentofu.org/hashicorp/aws\"]","instances":[{"index_key":0,"schema_version":0,"attributes":{"arn":"arn:aws:iam::054037125242:role/lambda-sample-plan","assume_role_policy":"{\"Statement\":[{\"Action\":\"sts:AssumeRoleWithWebIdentity\",\"Condition\":{\"StringEquals\":{\"token.actions.githubusercontent.com:aud\":\"sts.amazonaws.com\"},\"StringLike\":{\"token.actions.githubusercontent.com:sub\":\"repo:brikis98/fundamentals-of-devops-examples:*\"}},\"Effect\":\"Allow\",\"Principal\":{\"Federated\":\"arn:aws:iam::054037125242:oidc-provider/token.actions.githubusercontent.com\"}}],\"Version\":\"2012-10-17\"}","create_date":"2025-01-20T17:40:20Z","description":"","force_detach_policies":false,"id":"lambda-sample-plan","inline_policy":[],"managed_policy_arns":[],"max_session_duration":3600,"name":"lambda-sample-plan","name_prefix":"","path":"/","permissions_boundary":"","tags":null,"tags_all":{},"unique_id":"AROAQZFG5DB5LEY5VL2XQ"},"sensitive_attributes":[],"private":"bnVsbA==","dependencies":["module.iam_roles.data.aws_iam_policy_document.assume_role_policy_for_plan","module.oidc_provider.aws_iam_openid_connect_provider.github_actions","module.oidc_provider.data.tls_certificate.github"]}]},{"module":"module.iam_roles","mode":"managed","type":"aws_iam_role","name":"lambda_tests","provider":"provider[\"registry.opentofu.org/hashicorp/aws\"]","instances":[{"index_key":0,"schema_version":0,"attributes":{"arn":"arn:aws:iam::054037125242:role/lambda-sample-tests","assume_role_policy":"{\"Statement\":[{\"Action\":\"sts:AssumeRoleWithWebIdentity\",\"Condition\":{\"StringEquals\":{\"token.actions.githubusercontent.com:aud\":\"sts.amazonaws.com\"},\"StringLike\":{\"token.actions.githubusercontent.com:sub\":\"repo:brikis98/fundamentals-of-devops-examples:*\"}},\"Effect\":\"Allow\",\"Principal\":{\"Federated\":\"arn:aws:iam::054037125242:oidc-provider/token.actions.githubusercontent.com\"}}],\"Version\":\"2012-10-17\"}","create_date":"2025-01-20T17:40:20Z","description":"","force_detach_policies":false,"id":"lambda-sample-tests","inline_policy":[],"managed_policy_arns":[],"max_session_duration":3600,"name":"lambda-sample-tests","name_prefix":"","path":"/","permissions_boundary":"","tags":null,"tags_all":{},"unique_id":"AROAQZFG5DB5AAN36WFJR"},"sensitive_attributes":[],"private":"bnVsbA==","dependencies":["module.iam_roles.data.aws_iam_policy_document.assume_role_policy_for_tests","module.oidc_provider.aws_iam_openid_connect_provider.github_actions","module.oidc_provider.data.tls_certificate.github"]}]},{"module":"module.iam_roles","mode":"managed","type":"aws_iam_role_policy","name":"apply_serverless_app","provider":"provider[\"registry.opentofu.org/hashicorp/aws\"]","instances":[{"index_key":0,"schema_version":0,"attributes":{"id":"lambda-sample-apply:terraform-20250120174022938700000003","name":"terraform-20250120174022938700000003","name_prefix":"terraform-","policy":"{\"Version\":\"2012-10-17\",\"Statement\":[{\"Action\":[\"iam:UpdateRole\",\"iam:PassRole\",\"iam:List*Role*\",\"iam:Get*Role*\",\"iam:DeleteRole\",\"iam:CreateRole\"],\"Effect\":\"Allow\",\"Resource\":\"arn:aws:iam::*:role/lambda-sample*\",\"Sid\":\"IamPermissions\"},{\"Action\":[\"lambda:*\",\"apigatewayv2:*\",\"apigateway:*\"],\"Effect\":\"Allow\",\"Resource\":\"*\",\"Sid\":\"ServerlessPermissions\"},{\"Action\":\"s3:*\",\"Effect\":\"Allow\",\"Resource\":[\"arn:aws:s3:::fundamentals-of-devops-tofu-state/*\",\"arn:aws:s3:::fundamentals-of-devops-tofu-state\"],\"Sid\":\"TofuStateS3Permissions\"},{\"Action\":\"dynamodb:*\",\"Effect\":\"Allow\",\"Resource\":\"arn:aws:dynamodb:*:*:table/fundamentals-of-devops-tofu-state\",\"Sid\":\"TofuStateDynamoPermissions\"}]}","role":"lambda-sample-apply"},"sensitive_attributes":[],"private":"bnVsbA==","dependencies":["module.iam_roles.aws_iam_role.lambda_deploy_apply","module.iam_roles.data.aws_iam_policy_document.apply_serverless_app","module.iam_roles.data.aws_iam_policy_document.assume_role_policy_for_apply","module.oidc_provider.aws_iam_openid_connect_provider.github_actions","module.oidc_provider.data.tls_certificate.github"]}]},{"module":"module.iam_roles","mode":"managed","type":"aws_iam_role_policy","name":"plan_serverless_app","provider":"provider[\"registry.opentofu.org/hashicorp/aws\"]","instances":[{"index_key":0,"schema_version":0,"attributes":{"id":"lambda-sample-plan:terraform-20250120174022910900000002","name":"terraform-20250120174022910900000002","name_prefix":"terraform-","policy":"{\"Version\":\"2012-10-17\",\"Statement\":[{\"Action\":[\"iam:List*Role*\",\"iam:Get*Role*\"],\"Effect\":\"Allow\",\"Resource\":\"arn:aws:iam::*:role/lambda-sample*\",\"Sid\":\"IamReadOnlyPermissions\"},{\"Action\":[\"lambda:List*\",\"lambda:Get*\",\"apigatewayv2:Get*\",\"apigateway:GET\"],\"Effect\":\"Allow\",\"Resource\":\"*\",\"Sid\":\"ServerlessReadOnlyPermissions\"},{\"Action\":[\"s3:List*\",\"s3:Get*\"],\"Effect\":\"Allow\",\"Resource\":[\"arn:aws:s3:::fundamentals-of-devops-tofu-state/*\",\"arn:aws:s3:::fundamentals-of-devops-tofu-state\"],\"Sid\":\"TofuStateS3ReadOnlyPermissions\"}]}","role":"lambda-sample-plan"},"sensitive_attributes":[],"private":"bnVsbA==","dependencies":["module.iam_roles.aws_iam_role.lambda_deploy_plan","module.iam_roles.data.aws_iam_policy_document.assume_role_policy_for_plan","module.iam_roles.data.aws_iam_policy_document.plan_serverless_app","module.oidc_provider.aws_iam_openid_connect_provider.github_actions","module.oidc_provider.data.tls_certificate.github"]}]},{"module":"module.iam_roles","mode":"managed","type":"aws_iam_role_policy","name":"test_serverless_app","provider":"provider[\"registry.opentofu.org/hashicorp/aws\"]","instances":[{"index_key":0,"schema_version":0,"attributes":{"id":"lambda-sample-tests:terraform-20250120174022886800000001","name":"terraform-20250120174022886800000001","name_prefix":"terraform-","policy":"{\"Version\":\"2012-10-17\",\"Statement\":[{\"Action\":[\"iam:UpdateRole\",\"iam:PassRole\",\"iam:List*Role*\",\"iam:Get*Role*\",\"iam:DeleteRole\",\"iam:CreateRole\"],\"Effect\":\"Allow\",\"Resource\":\"arn:aws:iam::*:role/lambda-sample*\",\"Sid\":\"IamPermissions\"},{\"Action\":[\"lambda:*\",\"apigatewayv2:*\",\"apigateway:*\"],\"Effect\":\"Allow\",\"Resource\":\"*\",\"Sid\":\"ServerlessPermissions\"}]}","role":"lambda-sample-tests"},"sensitive_attributes":[],"private":"bnVsbA==","dependencies":["module.iam_roles.aws_iam_role.lambda_tests","module.iam_roles.data.aws_iam_policy_document.assume_role_policy_for_tests","module.iam_roles.data.aws_iam_policy_document.test_serverless_app","module.oidc_provider.aws_iam_openid_connect_provider.github_actions","module.oidc_provider.data.tls_certificate.github"]}]},{"module":"module.oidc_provider","mode":"data","type":"tls_certificate","name":"github","provider":"provider[\"registry.opentofu.org/hashicorp/tls\"]","instances":[{"schema_version":0,"attributes":{"certificates":[{"cert_pem":"-----BEGIN CERTIFICATE-----\nMIIFgTCCBGmgAwIBAgIQOXJEOvkit1HX02wQ3TE1lTANBgkqhkiG9w0BAQwFADB7\nMQswCQYDVQQGEwJHQjEbMBkGA1UECAwSR3JlYXRlciBNYW5jaGVzdGVyMRAwDgYD\nVQQHDAdTYWxmb3JkMRowGAYDVQQKDBFDb21vZG8gQ0EgTGltaXRlZDEhMB8GA1UE\nAwwYQUFBIENlcnRpZmljYXRlIFNlcnZpY2VzMB4XDTE5MDMxMjAwMDAwMFoXDTI4\nMTIzMTIzNTk1OVowgYgxCzAJBgNVBAYTAlVTMRMwEQYDVQQIEwpOZXcgSmVyc2V5\nMRQwEgYDVQQHEwtKZXJzZXkgQ2l0eTEeMBwGA1UEChMVVGhlIFVTRVJUUlVTVCBO\nZXR3b3JrMS4wLAYDVQQDEyVVU0VSVHJ1c3QgUlNBIENlcnRpZmljYXRpb24gQXV0\naG9yaXR5MIICIjANBgkqhkiG9w0BAQEFAAOCAg8AMIICCgKCAgEAgBJlFzYOw9sI\ns9CsVw127c0n00ytUINh4qogTQktZAnczomfzD2p7PbPwdzx07HWezcoEStH2jnG\nvDoZtF+mvX2do2NCtnbyqTsrkfjib9DsFiCQCT7i6HTJGLSR1GJk23+jBvGIGGqQ\nIjy8/hPwhxR79uQfjtTkUcYRZ0YIUcuGFFQ/vDP+fmyc/xadGL1RjjWmp2bIcmfb\nIWax1Jt4A8BQOujM8Ny8nkz+rwWWNR9XWrf/zvk9tyy29lTdyOcSOk2uTIq3XJq0\ntyA9yn8iNK5+O2hmAUTnAU5GU5szYPeUvlM3kHND8zLDU+/bqv50TmnHa4xgk97E\nxwzf4TKuzJM7UXiVZ4vuPVb+DNBpDxsP8yUmazNt925H+nND5X4OpWaxKXwyhGNV\nicQNwZNUMBkTrNN9N6frXTpsNVzbQdcS2qlJC9/YgIoJk2KOtWbPJYjNhLixP6Q5\nD9kCnusSTJV882sFqV4Wg8y4Z+LoE53MW4LTTLPtW//e5XOsIzstAL81VXQJSdhJ\nWBp/kjbmUZIO8yZ9HE0XvMnsQybQv0FfQKlERPSZ51eHnlAfV1SoPv10Yy+xUGUJ\n5lhCLkMaTLTwJUdZ+gQek9QmRkpQgbLevni3/GcV4clXhB4PY9bpYrrWX1Uu6lzG\nKAgEJTm4Diup8kyXHAc/DVL17e8vgg8CAwEAAaOB8jCB7zAfBgNVHSMEGDAWgBSg\nEQojPpbxB+zirynvgqV/0DCktDAdBgNVHQ4EFgQUU3m/WqorSs9UgOHYm8Cd8rID\nZsswDgYDVR0PAQH/BAQDAgGGMA8GA1UdEwEB/wQFMAMBAf8wEQYDVR0gBAowCDAG\nBgRVHSAAMEMGA1UdHwQ8MDowOKA2oDSGMmh0dHA6Ly9jcmwuY29tb2RvY2EuY29t\nL0FBQUNlcnRpZmljYXRlU2VydmljZXMuY3JsMDQGCCsGAQUFBwEBBCgwJjAkBggr\nBgEFBQcwAYYYaHR0cDovL29jc3AuY29tb2RvY2EuY29tMA0GCSqGSIb3DQEBDAUA\nA4IBAQAYh1HcdCE9nIrgJ7cz0C7M7PDmy14R3iJvm3WOnnL+5Nb+qh+cli3vA0p+\nrvSNb3I8QzvAP+u431yqqcau8vzY7qN7Q/aGNnwU4M309z/+3ri0ivCRlv79Q2R+\n/czSAaF9ffgZGclCKxO/WIu6pKJmBHaIkU4MiRTOok3JMrO66BQavHHxW/BBC5gA\nCiIDEOUMsfnNkjcZ7Tvx5Dq2+UUTJnWvu6rvP3t3O9LEApE9GQDTF1w52z97GA1F\nzZOFli9d31kWTz9RvdVFGD/tSo7oBmF0Ixa1DVBzJ0RHfxBdiSprhTEUxOipakyA\nvGp4z7h/jnZymQyd/teRCBaho1+V\n-----END CERTIFICATE-----\n","is_ca":true,"issuer":"CN=AAA Certificate Services,O=Comodo CA Limited,L=Salford,ST=Greater Manchester,C=GB","not_after":"2028-12-31T23:59:59Z","not_before":"2019-03-12T00:00:00Z","public_key_algorithm":"RSA","serial_number":"76359301477803385872276235234032301461","sha1_fingerprint":"d89e3bd43d5d909b47a18977aa9d5ce36cee184c","signature_algorithm":"SHA384-RSA","subject":"CN=USERTrust RSA Certification Authority,O=The USERTRUST Network,L=Jersey City,ST=New Jersey,C=US","version":3},{"cert_pem":"-----BEGIN CERTIFICATE-----\nMIIGEzCCA/ugAwIBAgIQfVtRJrR2uhHbdBYLvFMNpzANBgkqhkiG9w0BAQwFADCB\niDELMAkGA1UEBhMCVVMxEzARBgNVBAgTCk5ldyBKZXJzZXkxFDASBgNVBAcTC0pl\ncnNleSBDaXR5MR4wHAYDVQQKExVUaGUgVVNFUlRSVVNUIE5ldHdvcmsxLjAsBgNV\nBAMTJVVTRVJUcnVzdCBSU0EgQ2VydGlmaWNhdGlvbiBBdXRob3JpdHkwHhcNMTgx\nMTAyMDAwMDAwWhcNMzAxMjMxMjM1OTU5WjCBjzELMAkGA1UEBhMCR0IxGzAZBgNV\nBAgTEkdyZWF0ZXIgTWFuY2hlc3RlcjEQMA4GA1UEBxMHU2FsZm9yZDEYMBYGA1UE\nChMPU2VjdGlnbyBMaW1pdGVkMTcwNQYDVQQDEy5TZWN0aWdvIFJTQSBEb21haW4g\nVmFsaWRhdGlvbiBTZWN1cmUgU2VydmVyIENBMIIBIjANBgkqhkiG9w0BAQEFAAOC\nAQ8AMIIBCgKCAQEA1nMz1tc8INAA0hdFuNY+B6I/x0HuMjDJsGz99J/LEpgPLT+N\nTQEMgg8Xf2Iu6bhIefsWg06t1zIlk7cHv7lQP6lMw0Aq6Tn/2YHKHxYyQdqAJrkj\neocgHuP/IJo8lURvh3UGkEC0MpMWCRAIIz7S3YcPb11RFGoKacVPAXJpz9OTTG0E\noKMbgn6xmrntxZ7FN3ifmgg0+1YuWMQJDgZkW7w33PGfKGioVrCSo1yfu4iYCBsk\nHaswha6vsC6eep3BwEIc4gLw6uBK0u+QDrTBQBbwb4VCSmT3pDCg/r8uoydajotY\nuK3DGReEY+1vVv2Dy2A0xHS+5p3b4eTlygxfFQIDAQABo4IBbjCCAWowHwYDVR0j\nBBgwFoAUU3m/WqorSs9UgOHYm8Cd8rIDZsswHQYDVR0OBBYEFI2MXsRUrYrhd+mb\n+ZsF4bgBjWHhMA4GA1UdDwEB/wQEAwIBhjASBgNVHRMBAf8ECDAGAQH/AgEAMB0G\nA1UdJQQWMBQGCCsGAQUFBwMBBggrBgEFBQcDAjAbBgNVHSAEFDASMAYGBFUdIAAw\nCAYGZ4EMAQIBMFAGA1UdHwRJMEcwRaBDoEGGP2h0dHA6Ly9jcmwudXNlcnRydXN0\nLmNvbS9VU0VSVHJ1c3RSU0FDZXJ0aWZpY2F0aW9uQXV0aG9yaXR5LmNybDB2Bggr\nBgEFBQcBAQRqMGgwPwYIKwYBBQUHMAKGM2h0dHA6Ly9jcnQudXNlcnRydXN0LmNv\nbS9VU0VSVHJ1c3RSU0FBZGRUcnVzdENBLmNydDAlBggrBgEFBQcwAYYZaHR0cDov\nL29jc3AudXNlcnRydXN0LmNvbTANBgkqhkiG9w0BAQwFAAOCAgEAMr9hvQ5Iw0/H\nukdN+Jx4GQHcEx2Ab/zDcLRSmjEzmldS+zGea6TvVKqJjUAXaPgREHzSyrHxVYbH\n7rM2kYb2OVG/Rr8PoLq0935JxCo2F57kaDl6r5ROVm+yezu/Coa9zcV3HAO4OLGi\nH19+24rcRki2aArPsrW04jTkZ6k4Zgle0rj8nSg6F0AnwnJOKf0hPHzPE/uWLMUx\nRP0T7dWbqWlod3zu4f+k+TY4CFM5ooQ0nBnzvg6s1SQ36yOoeNDT5++SR2RiOSLv\nxvcRviKFxmZEJCaOEDKNyJOuB56DPi/Z+fVGjmO+wea03KbNIaiGCpXZLoUmGv38\nsbZXQm2V0TP2ORQGgkE49Y9Y3IBbpNV9lXj9p5v//cWoaasm56ekBYdbqbe4oyAL\nl6lFhd2zi+WJN44pDfwGF/Y4QA5C5BIG+3vzxhFoYt/jmPQT2BVPi7Fp2RBgvGQq\n6jG35LWjOhSbJuMLe/0CjraZwTiXWTb2qHSihrZe68Zk6s+go/lunrotEbaGmAhY\nLcmsJWTyXnW0OMGuf1pGg+pRyrbxmRE1a6Vqe8YAsOf4vmSyrcjC8azjUeqkk+B5\nyOGBQMkKW+ESPMFgKuOXwIlCypTPRpgSabuY0MLTDXJLR27lk8QyKGOHQ+SwMj4K\n00u/I5sUKUErmgQfky3xxzlIPK1aEn8=\n-----END CERTIFICATE-----\n","is_ca":true,"issuer":"CN=USERTrust RSA Certification Authority,O=The USERTRUST Network,L=Jersey City,ST=New Jersey,C=US","not_after":"2030-12-31T23:59:59Z","not_before":"2018-11-02T00:00:00Z","public_key_algorithm":"RSA","serial_number":"166627644428940058458651716034439089575","sha1_fingerprint":"33e4e80807204c2b6182a3a14b591acd25b5f0db","signature_algorithm":"SHA384-RSA","subject":"CN=Sectigo RSA Domain Validation Secure Server CA,O=Sectigo Limited,L=Salford,ST=Greater Manchester,C=GB","version":3},{"cert_pem":"-----BEGIN CERTIFICATE-----\nMIIHaDCCBlCgAwIBAgIRAJPStHPK5CQSa0JN71PyO7UwDQYJKoZIhvcNAQELBQAw\ngY8xCzAJBgNVBAYTAkdCMRswGQYDVQQIExJHcmVhdGVyIE1hbmNoZXN0ZXIxEDAO\nBgNVBAcTB1NhbGZvcmQxGDAWBgNVBAoTD1NlY3RpZ28gTGltaXRlZDE3MDUGA1UE\nAxMuU2VjdGlnbyBSU0EgRG9tYWluIFZhbGlkYXRpb24gU2VjdXJlIFNlcnZlciBD\nQTAeFw0yNDA3MDgwMDAwMDBaFw0yNTA3MDgyMzU5NTlaMCoxKDAmBgNVBAMMHyou\nYWN0aW9ucy5naXRodWJ1c2VyY29udGVudC5jb20wggIiMA0GCSqGSIb3DQEBAQUA\nA4ICDwAwggIKAoICAQDo4bImOjN2CKPLUnYciOPgwTvPUMG34nROjJCpDRdP+8Wv\nfsTf8oyR7gtVKSmDdkFWYPt7wWk20xbECEZdiCYqhcXsoWqfqCKEfp/cruNzwtQK\ncsfmpziyhnuQuQ+n6TL6cewi8+mdSgTUt7UDKSPaM7X5dJiQ/Au54Tj7l2T8Wf+g\n8PZdsAWUfmu+Ku8YxoBo4QaeSPxiZcPpMLzdy2wMV6RoA8t0uJSFztJAQu6rsgOl\nG1KK0TqTjGsNQz2FTISR7JEaDH9NK7BXJIXRG9Jn64LKHnC0cnF/y/kZ/qO1E+Bn\nMpLZOz2O8LcOMQU2LwlLESEBWaOHaWXryoJDPC03HNI4ysDKfHwQJtUkNFLrpOm6\nIsB409EhgW5jgGaNJGMatW4LKeuatmpwGRmQNLUPu5inpE8ogu7MdAej/DPGWUm8\nanjWIdK/61Gj/XDnHbFhInCvupY7yBiSbgDgs6t+F67Dyu6EiSP8trp1ejKr9kOj\n/0nFNu5lKqqUVXO9ZdAMmARtaWN23gLMxbGOJyvZXfvSoWYli+hNaiiafewcoIRH\n2U9/+wTltsuIDWAAkZMQ5uAJZvZ0c280MI1ZxFjYhjUZtuzqoCP49tJ9e9/ku72/\nUW00KWbHrrUUDcJd2o2xP3hLmlbexqkWhGksv4hbP0x6d2MPO+/8uTbXY4ORfwID\nAQABo4IDITCCAx0wHwYDVR0jBBgwFoAUjYxexFStiuF36Zv5mwXhuAGNYeEwHQYD\nVR0OBBYEFBB+AKRKk8n6lBaK7fGe1WquRSwKMA4GA1UdDwEB/wQEAwIFoDAMBgNV\nHRMBAf8EAjAAMB0GA1UdJQQWMBQGCCsGAQUFBwMBBggrBgEFBQcDAjBJBgNVHSAE\nQjBAMDQGCysGAQQBsjEBAgIHMCUwIwYIKwYBBQUHAgEWF2h0dHBzOi8vc2VjdGln\nby5jb20vQ1BTMAgGBmeBDAECATCBhAYIKwYBBQUHAQEEeDB2ME8GCCsGAQUFBzAC\nhkNodHRwOi8vY3J0LnNlY3RpZ28uY29tL1NlY3RpZ29SU0FEb21haW5WYWxpZGF0\naW9uU2VjdXJlU2VydmVyQ0EuY3J0MCMGCCsGAQUFBzABhhdodHRwOi8vb2NzcC5z\nZWN0aWdvLmNvbTCCAX8GCisGAQQB1nkCBAIEggFvBIIBawFpAHUA3dzKNJXX4RYF\n55Uy+sef+D0cUN/bADoUEnYKLKy7yCoAAAGQj6U8BgAABAMARjBEAiAqLo8wDJRk\nWL+JMB3JmexKL4ugh5NP0dFIZMU2TY2bswIgQHtzAFZqQmJun/RUdngNRDmkA3HK\nGiXY0QmVwul/BpAAdwAN4fIwK9MNwUBiEgnqVS78R3R8sdfpMO8OQh60fk6qNAAA\nAZCPpTvcAAAEAwBIMEYCIQDizVlgOl4dSjw8rj64tNqly5EHdNOawh+JoPS8cwbl\ndgIhAJsW/Rxv4xVc/QLU6IajxC8CbEPTpOMRLXA7DhqzVn7EAHcAEvFONL1TckyE\nBhnDjz96E/jntWKHiJxtMAWE6+WGJjoAAAGQj6U7qwAABAMASDBGAiEAx7qSQTPH\nDFkvcOfgioODlWNRhZvOO3tnTO4kYt1ubPMCIQCQgl9KCM4j+C66C2/S87bTnQ6t\n9AXo9qI68HsRRqDSizBJBgNVHREEQjBAgh8qLmFjdGlvbnMuZ2l0aHVidXNlcmNv\nbnRlbnQuY29tgh1hY3Rpb25zLmdpdGh1YnVzZXJjb250ZW50LmNvbTANBgkqhkiG\n9w0BAQsFAAOCAQEAVb9+iUtlsPIfBDLYuOOD0Cn2T3Au0QDjbwRsY3TYIqSjwemk\n5CYuecJnFyOM6FVZ5IwZtr7gBbgLECiIGe7kN/zZ2gIXRKnH3Sk3WatYWKt4disK\nHMHjkaJzsVYE+oSnEuW+hOJiYDCPbRt2bKrdmVScoFJ5QKuEQczFefCEjaoQf1S4\n4YMniGkl+RfsLXCkdsq/ylAZMGqFGTpDtwxmt2NMQiH5vD8BaD+tbsKQ9O/9tSFI\nH56u+fcqnh55elQyE+HunPZGJ42KovjahZC6ubBCkZFmdybJth76EHqJRE595wwQ\nlUS6z5DuTN7D7iYE3dMool/bpxeLWJhj0lKzvw==\n-----END CERTIFICATE-----\n","is_ca":false,"issuer":"CN=Sectigo RSA Domain Validation Secure Server CA,O=Sectigo Limited,L=Salford,ST=Greater Manchester,C=GB","not_after":"2025-07-08T23:59:59Z","not_before":"2024-07-08T00:00:00Z","public_key_algorithm":"RSA","serial_number":"196490557728434070975673617422193146805","sha1_fingerprint":"74f3a68f16524f15424927704c9506f55a9316bd","signature_algorithm":"SHA256-RSA","subject":"CN=*.actions.githubusercontent.com","version":3}],"content":null,"id":"8d232a145587e7e891fc7c3dc13630d472810d21","url":"https://token.actions.githubusercontent.com","verify_chain":true},"sensitive_attributes":[]}]},{"module":"module.oidc_provider","mode":"managed","type":"aws_iam_openid_connect_provider","name":"github_actions","provider":"provider[\"registry.opentofu.org/hashicorp/aws\"]","instances":[{"schema_version":0,"attributes":{"arn":"arn:aws:iam::054037125242:oidc-provider/token.actions.githubusercontent.com","client_id_list":["sts.amazonaws.com"],"id":"arn:aws:iam::054037125242:oidc-provider/token.actions.githubusercontent.com","tags":null,"tags_all":{},"thumbprint_list":["d89e3bd43d5d909b47a18977aa9d5ce36cee184c"],"url":"token.actions.githubusercontent.com"},"sensitive_attributes":[],"private":"bnVsbA==","dependencies":["module.oidc_provider.data.tls_certificate.github"]}]}],"check_results":null}
